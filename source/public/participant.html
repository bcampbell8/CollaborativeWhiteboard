<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport">
    <title>Participant</title>
</head>

<body>
<iframe id="iframe" allowfullscreen="false" src="/body.html" frameBorder="0"></iframe>
<style>
#iframe {
	width: 98vw;
	height: 95.9vh;
}
</style>
<script>
// distict participant-only code for websockets
// everything else is abstracted into other files and imported accordingly

const socket = new WebSocket("ws://" + window.location.hostname + ":2210");
const roomCode = window.location.pathname.split('/').pop();
socket.onopen = function(event) {
	console.log("socket opened");
	socket.send(JSON.stringify({ action: "connect", code: `${roomCode}`, info: null }));
};
socket.onmessage = function(event) {
	alert("msg recieved from server: " + event.data);
};


// canvas must be serialised and transmitted over the network from this scriptfile
// the event listener allows this file to be updated once new lines have been drawn inside the iframe
window.document.addEventListener("iframeCanvas", (e) => {
	console.log(e.detail); // e is an object with property `detail` which contains the serialised canvas
}, false);

// socket.send(`${code};${history[history.length - 1]}`);
</script>
<script src="/canvas.js"></script>
</body>
</html>





